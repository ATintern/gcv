'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var GCV=GCV||{};GCV.Viewer=function(){_createClass(_class2,[{key:'_longestString',value:function _longestString(text){var dummy=this.viewer.append('g'),max=0;dummy.selectAll('.dummyText').data(text).enter().append('text').text(function(s){return s}).each(function(s,i){var l=this.getComputedTextLength();if(l>max)max=l;this.remove()});dummy.remove();return max}},{key:'_resize',value:function _resize(){var w=this.container.clientWidth,r1=this.left+2*this._PAD,r2=w-(this.right+this._PAD);this.viewer.attr('width',w);this.x.range([r1,r2])}},{key:'_decorateResize',value:function _decorateResize(d){this._resize=function(resize){resize();d()}.bind(this,this._resize)}},{key:'_init',value:function _init(id,data,options){this.container=document.getElementById(id);if(this.container===null){throw new Error('"'+id+'" is not a valid element ID')}this.data=data;if(this.data===undefined){throw new Error('\'data\' is undefined')}this.viewer=d3.select('#'+id).append('svg').attr('class','GCV').attr('height',this._PAD);var minX=Infinity,maxX=-Infinity;var names=data.groups.map(function(g){var min=Infinity,max=-Infinity;for(var i=0;i<g.genes.length;i++){var gene=g.genes[i],fmax=gene.fmax,fmin=gene.fmin,x=gene.x;min=Math.min.apply(null,[min,fmax,fmin]);max=Math.max.apply(null,[max,fmax,fmin]);minX=Math.min(minX,x);maxX=Math.max(maxX,x)}return g.chromosome_name+':'+min+'-'+max});this.left=this._longestString(names);this.x=d3.scale.linear().domain([minX,maxX]);var numTracks=data.groups.length,bottom=this._PAD+this._TRACK_HEIGHT*numTracks;this.y=d3.scale.linear().domain([0,numTracks-1]).range([this._PAD,bottom]);this.options=options||{};this.options.nameClick=options.nameClick||function(y,i){};this.options.geneClick=options.geneClick||function(b){};this.options.plotClick=options.plotClick;this.options.autoResize=options.autoResize||false;this.right=options.plotClick?this._longestString(['plot']):this._PAD;this._resize=this._resize.bind(this);this._resize()}}]);function _class2(id,color,data,options){_classCallCheck(this,_class2);this._PAD=2;this._TRACK_HEIGHT=30;console.log(data);this._init(id,data,options)}return _class2}();

